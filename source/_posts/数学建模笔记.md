---
layout: pages
title: 数学建模笔记
date: 2018-08-19 11:21:17
tags: math
---
### katex公式编辑文档
https://khan.github.io/KaTeX/docs/supported.html
### 公式编辑示例
```katex
{% katex [displayMode] %}
a^{b^{\sqrt{c}}}
{% endkatex %}
```
加上[displayMode]参数表示内联{% katex [displayMode] %}
\begin{pmatrix}
   a & b \\
   c & d
\end{pmatrix}
{% endkatex %}，否则换行居中
{% katex %}
\int_1^5 {a^{b^{\sqrt{c}}}}dx
{% endkatex %}


### scipy.optimize

> 功能清单-[查看官方api](https://docs.scipy.org/doc/scipy-1.1.0/reference/optimize.html#module-scipy.optimize)

#### 一、优化（minimize or optimize）
- 局部优化 (local ~求局部最小值) --minimize()
- 全局优化 (global ~)
#### 二、拟合 (fitting)
- 最小二乘法 --curve_fit() 
#### 三、求根(root finding)或不动点(fixed point)
- 二分法、牛顿法求解,分标量和矢量（即维度）
#### 四、线性规划
- linprog()
- **由于scipy不支持整数线性规划问题，推荐使用pulp模块求解线性规划，不过据说lingo是线性规划问题的最优选择**

### 线性规划问题(linear programming)
1. 常规线性规划，目标函数+条件(不等式与等式条件)
2. 整数规划、混合整数规划、0-1规划

### Matlab命令
- vpa()转化为小数表达形式
- vpasolve(),roots()求方程实数解（去掉Real参数可求符号通解）
    ```matlab
    syms x
    vpasolve(x^4 - 7*x^3 + 3*x^2 - 5*x + 9,x)
    ```
    等价于
    ```matlab
    roots([1 -7 3 -5 9])  % 系数对齐
    ```
- limit(fun,point)，求函数极限
- diff(fun), 求符号导数
- int(fun，[a,b]), 求符号不定积分或定积分
- subs(fun,value),符号函数求值
- isequal(A,B) 判断两个值是否相等(可以为数组或矩阵，或符号函数)
- syms()可以同时声明多个变量以及符号函数，sym不能声明符号函数
- ezplot画椭圆曲线：
    ```matlab
    syms f(x)
    f(x) = x^2 +3*y^2 -5
    ezplot(f)
    ```

### 数学建模方法
- 机理分析，通过对实际问题原理进行分析，建立相应的模型，即白箱问题。
- 测试分析，黑箱问题，问题内部原理不可知，通过对观测数值进行拟合。
- 一般结合两种方式解决问题，通过机理分析初步建立模型，测试分析确定参数。


```matlab
% 暑期作业第二题
% 对应数据变为
T = [0:100:900];
C = [454 499 535 565 590 610 626 639 650 659];
V = 1000;
S = 10;
% 假设条件：
% 1. 薄膜两侧表面各处的液体浓度均匀
% 2. 以100s时为起始时间
% 3. 总质量为m，C1*V1+C2*V2 = m， 设C1+C2 = m/V = M
% 4. t时刻，A测浓度为x(t)
% 设记录的浓度为A侧浓度，该浓度随时间推移而增大。
syms M x(t) K a p xdata;
eq = diff(x) == K*(M-2*x);
x(t) = dsolve(eq,x(0)==454);
fun1 = matlabFunction(x);
fun2 = @(p,xdata) fun1(xdata,p(1),p(2));
p = lsqcurvefit(fun2,[1,1],T,C);

fun2(p,T)
ans =
   454   597   597   597   597   597   597   597   597   597
```

### 最小二乘拟合中的坑

1. 参数初始值对拟合影响很大，包括能否拟合出结果以及拟合结果的正确性，今天用血的体验证明了拟合可能存在局部陷阱。下面来说说今天遇到的问题。
```matlab
% 暑期作业第二题
T = [0:100:900];
C = [454 499 535 565 590 610 626 639 650 659];
V = 1000;
S = 10;
% 假设条件：
% 1. 薄膜两侧表面各处的液体浓度均匀
% 2. 以100s时为起始时间
% 3. 总质量为m，C1*V1+C2*V2 = m， 设C1+C2 = m/V = M
% 4. t时刻，A测浓度为x(t)
% 设记录的浓度为A侧浓度，该浓度随时间推移而增大。
syms M x(t) K a p xdata;
eq = diff(x) == K*(M-2*x);
x(t) = dsolve(eq,x(0)==454);
fun1 = matlabFunction(x);

% 用于拟合的目标函数
fun2 = @(p,xdata) fun1(xdata,p(1),p(2));
% 拟合
p = lsqcurvefit(fun2,[1,1],T,C);
% 检验
fun2(p,T)
ans =
   454   597   597   597   597   597   597   597   597   597
```
从上面的检验结果可以看出，和真实情况相差甚远，画出函数图像
![fig](https://raw.githubusercontent.com/geekhch/hexo/master/images/auto/math_1.png?raw=true)
再查看带入参数的函数表达式
```MATLAB
>> vpa(fun2(p,t),6)
```
{% katex %}
ans = 597.0 - 143.0*e^{-24.94t}
{% endkatex %}
可以看出，参数p(2)决定函数趋于无穷大的渐近线，根据C值估计在1000，左右，而图像之所以像直线，是因为exp的指数太大，导致变化太快，从而按10倍减小参数p1到0.001,此时拟合出正确的结果。
{% katex %}
ans = 698.5-244.5*e^{-0.002024t}
{% endkatex %}
